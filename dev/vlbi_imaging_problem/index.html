<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction to the VLBI Imaging Problem · Comrade.jl</title><meta name="title" content="Introduction to the VLBI Imaging Problem · Comrade.jl"/><meta property="og:title" content="Introduction to the VLBI Imaging Problem · Comrade.jl"/><meta property="twitter:title" content="Introduction to the VLBI Imaging Problem · Comrade.jl"/><meta name="description" content="Documentation for Comrade.jl."/><meta property="og:description" content="Documentation for Comrade.jl."/><meta property="twitter:description" content="Documentation for Comrade.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Comrade.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../benchmarks/">Benchmarks</a></li><li class="is-active"><a class="tocitem" href>Introduction to the VLBI Imaging Problem</a><ul class="internal"><li><a class="tocitem" href="#Likelihood"><span>Likelihood</span></a></li><li><a class="tocitem" href="#Prior-Model"><span>Prior Model</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../conventions/">Conventions</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/ClosureImaging/">Imaging a Black Hole using only Closure Quantities</a></li><li><a class="tocitem" href="../tutorials/GeometricModeling/">Geometric Modeling of EHT Data</a></li><li><a class="tocitem" href="../tutorials/HybridImaging/">Hybrid Imaging of a Black Hole</a></li><li><a class="tocitem" href="../tutorials/LoadingData/">Loading Data into Comrade</a></li><li><a class="tocitem" href="../tutorials/PolarizedImaging/">Polarized Image and Instrumental Modeling</a></li><li><a class="tocitem" href="../tutorials/StokesIImaging/">Stokes I Simultaneous Image and Instrument Modeling</a></li></ul></li><li><span class="tocitem">Libraries</span><ul><li><a class="tocitem" href="../libs/optimization/">ComradeOptimization</a></li><li><a class="tocitem" href="../libs/ahmc/">ComradeAHMC</a></li><li><a class="tocitem" href="../libs/nested/">ComradeNested</a></li><li><a class="tocitem" href="../libs/dynesty/">ComradeDynesty</a></li><li><a class="tocitem" href="../libs/adaptmcmc/">ComradeAdaptMCMC</a></li></ul></li><li><a class="tocitem" href="../base_api/">ComradeBase API</a></li><li><a class="tocitem" href="../api/">Comrade API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Introduction to the VLBI Imaging Problem</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Introduction to the VLBI Imaging Problem</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ptiede/Comrade.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ptiede/Comrade.jl/blob/main/docs/src/vlbi_imaging_problem.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Introduction-to-the-VLBI-Imaging-Problem"><a class="docs-heading-anchor" href="#Introduction-to-the-VLBI-Imaging-Problem">Introduction to the VLBI Imaging Problem</a><a id="Introduction-to-the-VLBI-Imaging-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction-to-the-VLBI-Imaging-Problem" title="Permalink"></a></h1><p>Very-long baseline interferometry (VLBI) is capable of taking the highest resolution images in the world, achieving angular resolutions of ~20 μas. In 2019, the first-ever image of a black hole was produced by the Event Horizon Telescope (EHT). However, while the EHT has unprecedented resolution, it is also a sparse interferometer. As a result, the sampling in the uv or Fourier space of the image is incomplete. This incompleteness makes the imaging problem uncertain. Namely, infinitely many images are possible, given the data. <code>Comrade</code> is a imaging/modeling package that aims to quantify this uncertainty using Bayesian inference.</p><p>If we denote visibilities by <code>V</code> and the image structure/model by <code>I</code>, <code>Comrade</code> will then compute the posterior or the probability of an image given the visibility data or in an equation</p><p class="math-container">\[p(I|V) = \frac{p(V|I)p(I)}{p(V)}.\]</p><p>Here <span>$p(V|I)$</span> is known as the likelihood and describes the probability distribution of the data given some image <code>I</code>. The prior <span>$p(I)$</span> encodes prior knowledge of the image structure. This prior includes distributions of model parameters and even the model itself. Finally, the denominator <span>$p(V)$</span> is a normalization term and is known as the marginal likelihood or evidence and can be used to assess how well particular models fit the data.</p><p>Therefore, we must specify the likelihood and prior to construct our posterior. Below we provide a brief description of the likelihoods and models/priors that <code>Comrade</code> uses. However, if the user wants to see how everything works first, they should check out the </p><h2 id="Likelihood"><a class="docs-heading-anchor" href="#Likelihood">Likelihood</a><a id="Likelihood-1"></a><a class="docs-heading-anchor-permalink" href="#Likelihood" title="Permalink"></a></h2><p>Following TMS<sup class="footnote-reference"><a id="citeref-TMS" href="#footnote-TMS">[TMS]</a></sup>, we note that the likelihood for a single complex visibility at baseline <span>$u_{ij}, v_{ij}$</span> is</p><p class="math-container">\[p(V_{ij} | I) = (2\pi \sigma^2_{ij})^{-1/2}\exp\left(-\frac{| V_{ij} - g_ig_j^*\tilde{I}_{ij}(I)|^2}{2\sigma^2_{ij}}\right).\]</p><p>In this equation, <span>$\tilde{I}$</span> is the Fourier transform of the image <span>$I$</span>, and <span>$g_{i,j}$</span> are complex numbers known as gains. The gains arise due to atmospheric and telescope effects and corrupt the incoming signal. Therefore, if a user attempts to model the complex visibilities, they must also model the complex gains. An example showing how to model gains in <code>Comrade</code> can be found in </p><p>Modeling the gains can be computationally expensive, especially if our image model is simple. For instance, in <code>Comrade</code>, we have a wide variety of geometric models. These models tend to have a small number of parameters and are simple to evaluate. Solving for gains then drastically increases the amount of time it takes to sample the posterior. As a result, part of the typical EHT analysis<sup class="footnote-reference"><a id="citeref-M87P6" href="#footnote-M87P6">[M87P6]</a></sup><sup class="footnote-reference"><a id="citeref-SgrAP4" href="#footnote-SgrAP4">[SgrAP4]</a></sup> instead uses closure products as its data. The two forms of closure products are:</p><ul><li>Closure Phases,</li><li>Log-Closure Amplitudes.</li></ul><p>Closure Phases <span>$\psi$</span> are constructed by selecting three baselines <span>$(i,j,k)$</span> and finding the argument of the bispectrum:</p><p class="math-container">\[    \psi_{ijk} = \arg V_{ij}V_{jk}V_{ki}.\]</p><p>Similar log-closure amplitudes are found by selecting four baselines <span>$(i,j,k,l)$</span> and forming the closure amplitudes:</p><p class="math-container">\[    A_{ijkl} = \frac{ |V_{ij}||V_{kl}|}{|V_{jk}||V_{li}|}.\]</p><p>Instead of directly fitting closure amplitudes, it turns out that the statistically better-behaved data product is the log-closure amplitude. </p><p>The benefit of fitting closure products is that they are independent of complex gains, so we can leave them out when modeling the data. However, the downside is that they effectively put uniform improper priors on the gains<sup class="footnote-reference"><a id="citeref-Blackburn" href="#footnote-Blackburn">[Blackburn]</a></sup>, meaning that we often throw away information about the telescope&#39;s performance. On the other hand, we can then view closure fitting as a very conservative estimate about what image structures are consistent with the data. Another downside of using closure products is that their likelihoods are complex. In the high-signal-to-noise limit, however, they do reduce to Gaussian likelihoods, and this is the limit we are usually in for the EHT. For the explicit likelihood <code>Comrade</code> uses, we refer the reader to <a href="https://iopscience.iop.org/article/10.3847/2041-8213/ac6736#apjlac6736app6">appendix F</a> in paper IV of the first Sgr A* EHT publications<sup class="footnote-reference"><a id="citeref-SgrAP4" href="#footnote-SgrAP4">[SgrAP4]</a></sup>. The computational implementation of these likelihoods can be found in <a href="https://github.com/ptiede/VLBILikelihoods.jl">VLBILikelihoods.jl</a>.</p><h2 id="Prior-Model"><a class="docs-heading-anchor" href="#Prior-Model">Prior Model</a><a id="Prior-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Prior-Model" title="Permalink"></a></h2><p><code>Comrade</code> has included a large number of possible models (see <a href="../api/#Comrade-API">Comrade API</a> for a list). These can be broken down into two categories:</p><ol><li>Parametric or <em>geometric models</em></li><li>Non-parametric or <em>image models</em></li></ol><p><code>Comrade</code>&#39;s geometric model interface is built using <a href="https://github.com/EHTJulia/VLBISkyModels.jl">VLBISkyModels</a> and is different from other EHT modeling packages because we don&#39;t directly provide fully formed models. Instead, we offer simple geometric models, which we call <strong>primitives</strong>. These primitive models can then be <strong>modified</strong> and combined to form complicated  image structures. For more information, we refer the reader to the  <a href="https://ehtjulia.github.io/VLBISkyModels.jl/stable/">VLBISkyModels docs</a>.</p><p>Additionally, we include an interface to Bayesian imaging methods, where we directly fit a rasterized image to the data. These models are highly flexible and assume very little about the image structure. In that sense, these methods are an excellent way to explore the data first and see what kinds of image structures are consistent with observations. For an example of how to fit an image model to closure products, we refer the reader to the other tutorial included in the docs.</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-TMS"><a class="tag is-link" href="#citeref-TMS">TMS</a>Thompson, A., Moran, J., Swenson, G. (2017). Interferometry and Synthesis in Radio Astronomy (Third). Springer Cham</li><li class="footnote" id="footnote-M87P6"><a class="tag is-link" href="#citeref-M87P6">M87P6</a>Event Horizon Telescope Collaboration, (2022). First M87 Event Horizon Telescope Results. VI. The Shadow and Mass of the Central Black Hole. ApJL 875 L6 <a href="https://doi.org/10.3847/2041-8213/ab1141">doi</a></li><li class="footnote" id="footnote-SgrAP4"><a class="tag is-link" href="#citeref-SgrAP4">SgrAP4</a>Event Horizon Telescope Collaboration, (2022). First Sagittarius A* Event Horizon Telscope Results. IV. Variability, Morphology, and Black Hole Mass. ApJL 930 L15 <a href="https://doi.org/10.3847/2041-8213/ac6736">arXiv</a></li><li class="footnote" id="footnote-Blackburn"><a class="tag is-link" href="#citeref-Blackburn">Blackburn</a>Blackburn, L., et. al. (2020). Closure statistics in interferometric data. ApJ, 894(1), 31.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../benchmarks/">« Benchmarks</a><a class="docs-footer-nextpage" href="../conventions/">Conventions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Wednesday 21 February 2024 20:21">Wednesday 21 February 2024</span>. Using Julia version 1.10.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
